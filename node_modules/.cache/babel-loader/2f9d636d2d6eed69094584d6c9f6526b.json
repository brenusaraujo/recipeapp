{"ast":null,"code":"import _toConsumableArray from\"/Users/brenoaraujo/projects-to-github/RecipeApp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"/Users/brenoaraujo/projects-to-github/RecipeApp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/brenoaraujo/projects-to-github/RecipeApp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{useHistory}from'react-router';import{setRecipeProgress,getRecipeProgress,setFavoriteRecipes,getFavoriteRecipes,getDoneRecipes,setDoneRecipes}from'../services/localStorage';import ShareButton from'./ShareButton';import FavoriteButton from'./FavoriteButton';import{checkIngredientChange,loadProgressPage}from'../helpers';function ProgressCard(_ref){var photo=_ref.photo,title=_ref.title,category=_ref.category,ingredients=_ref.ingredients,measures=_ref.measures,instructions=_ref.instructions,type=_ref.type,id=_ref.id,area=_ref.area,alcoholic=_ref.alcoholic,tags=_ref.tags;var history=useHistory();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isCopied=_useState2[0],setIsCopied=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isFavorite=_useState4[0],setIsFavorite=_useState4[1];var _useState5=useState(true),_useState6=_slicedToArray(_useState5,2),isDisabled=_useState6[0],setIsDisabled=_useState6[1];useEffect(function(){if(!getRecipeProgress()){return setRecipeProgress({cocktails:{},meals:{}});}},[]);useEffect(function(){return loadProgressPage(type,id,photo);},[photo,id,type]);useEffect(function(){if(getFavoriteRecipes()){return setIsFavorite(getFavoriteRecipes().find(function(recipe){return recipe.id===id;}));}setFavoriteRecipes([]);},[id]);var handleFinishButton=function handleFinishButton(){if(ingredients.length===getRecipeProgress()[type][id].length){return setIsDisabled(false);}return setIsDisabled(true);};var handleCheck=function handleCheck(_ref2,index){var checked=_ref2.target.checked;var liSearch=document.querySelectorAll('li')[index];var parameters=[checked,index,type,id,liSearch];checkIngredientChange(parameters);return handleFinishButton();};var handleFavoriteDependencies={id:id,type:type==='meals'?'comida':'bebida',area:area,category:category,alcoholicOrNot:type==='meals'?'':alcoholic,name:title,image:photo};var handleFinish=function handleFinish(){if(!getDoneRecipes()){setDoneRecipes([_objectSpread(_objectSpread({},handleFavoriteDependencies),{},{doneDate:new Date(),tags:tags})]);}else{setDoneRecipes([].concat(_toConsumableArray(getDoneRecipes()),[_objectSpread(_objectSpread({},handleFavoriteDependencies),{},{doneDate:new Date(),tags:tags})]));}history.push('/receitas-feitas');};return/*#__PURE__*/React.createElement(\"div\",{className:\"page-container\"},/*#__PURE__*/React.createElement(\"img\",{className:\"details__image\",\"data-testid\":\"recipe-photo\",src:photo,alt:\"meal info\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"title-container\"},/*#__PURE__*/React.createElement(\"div\",{className:\"titles\"},/*#__PURE__*/React.createElement(\"p\",{className:\"details__category\",\"data-testid\":\"recipe-category\"},type==='meals'?category:alcoholic),/*#__PURE__*/React.createElement(\"h1\",{className:\"details__title\",\"data-testid\":\"recipe-title\"},title)),/*#__PURE__*/React.createElement(\"div\",{className:\"details\"},/*#__PURE__*/React.createElement(ShareButton,{textToCopy:\"http://localhost:3000/\".concat(type==='meals'?'comidas':'bebidas',\"/\").concat(id),setIsCopied:setIsCopied,isCopied:isCopied}),/*#__PURE__*/React.createElement(FavoriteButton,{isFavorite:isFavorite,setIsFavorite:setIsFavorite,id:id,favoriteDependencies:handleFavoriteDependencies}))),/*#__PURE__*/React.createElement(\"p\",{className:\"details__description margin-left\"},\"Ingredientes:\"),/*#__PURE__*/React.createElement(\"ul\",{className:\"ingredient-list\"},ingredients.map(function(item,index){return/*#__PURE__*/React.createElement(\"li\",{className:\"details__ingredient\",key:item,\"data-testid\":\"\".concat(index,\"-ingredient-step\")},/*#__PURE__*/React.createElement(\"input\",{className:\"ingredient__checkbox\",onChange:function onChange(e){return handleCheck(e,index);},type:\"checkbox\"}),/*#__PURE__*/React.createElement(\"span\",{className:\"details__ingredient-name\"},\"\".concat(item,\": \")),/*#__PURE__*/React.createElement(\"span\",{className:\"details__measure\"},measures[index]));})),/*#__PURE__*/React.createElement(\"p\",{className:\"details__description--instructions\"},\"Instru\\xE7\\xF5es:\"),/*#__PURE__*/React.createElement(\"p\",{className:\"details__instructions\",\"data-testid\":\"instructions\"},instructions),/*#__PURE__*/React.createElement(\"button\",{className:isDisabled?'login__btn disabled':'login__btn start-recipe',onClick:handleFinish,type:\"button\",\"data-testid\":\"finish-recipe-btn\",disabled:isDisabled},\"Finalizar receita\"));}ProgressCard.defaultProps={photo:'',title:'',category:'',ingredients:[],measures:[],instructions:'',type:'',id:'',area:'',alcoholic:'',tags:''};export default ProgressCard;","map":{"version":3,"names":["React","useState","useEffect","useHistory","setRecipeProgress","getRecipeProgress","setFavoriteRecipes","getFavoriteRecipes","getDoneRecipes","setDoneRecipes","ShareButton","FavoriteButton","checkIngredientChange","loadProgressPage","ProgressCard","photo","title","category","ingredients","measures","instructions","type","id","area","alcoholic","tags","history","isCopied","setIsCopied","isFavorite","setIsFavorite","isDisabled","setIsDisabled","cocktails","meals","find","recipe","handleFinishButton","length","handleCheck","index","checked","target","liSearch","document","querySelectorAll","parameters","handleFavoriteDependencies","alcoholicOrNot","name","image","handleFinish","doneDate","Date","push","map","item","e","defaultProps"],"sources":["/Users/brenoaraujo/projects-to-github/RecipeApp/src/components/ProgressCard.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport PropTypes from 'prop-types';\nimport { useHistory } from 'react-router';\nimport {\n  setRecipeProgress,\n  getRecipeProgress,\n  setFavoriteRecipes,\n  getFavoriteRecipes,\n  getDoneRecipes,\n  setDoneRecipes,\n} from '../services/localStorage';\nimport ShareButton from './ShareButton';\nimport FavoriteButton from './FavoriteButton';\nimport { checkIngredientChange, loadProgressPage } from '../helpers';\n\nfunction ProgressCard({\n  photo,\n  title,\n  category,\n  ingredients,\n  measures,\n  instructions,\n  type,\n  id,\n  area,\n  alcoholic,\n  tags,\n}) {\n  const history = useHistory();\n  const [isCopied, setIsCopied] = useState(false);\n  const [isFavorite, setIsFavorite] = useState(false);\n  const [isDisabled, setIsDisabled] = useState(true);\n\n  useEffect(() => {\n    if (!getRecipeProgress()) {\n      return setRecipeProgress({\n        cocktails: {},\n        meals: {},\n      });\n    }\n  }, []);\n\n  useEffect(() => loadProgressPage(type, id, photo), [photo, id, type]);\n\n  useEffect(() => {\n    if (getFavoriteRecipes()) {\n      return setIsFavorite(\n        getFavoriteRecipes().find((recipe) => recipe.id === id),\n      );\n    }\n    setFavoriteRecipes([]);\n  }, [id]);\n\n  const handleFinishButton = () => {\n    if (ingredients.length === getRecipeProgress()[type][id].length) {\n      return setIsDisabled(false);\n    }\n    return setIsDisabled(true);\n  };\n\n  const handleCheck = ({ target: { checked } }, index) => {\n    const liSearch = document.querySelectorAll('li')[index];\n    const parameters = [checked, index, type, id, liSearch];\n    checkIngredientChange(parameters);\n    return handleFinishButton();\n  };\n\n  const handleFavoriteDependencies = {\n    id,\n    type: type === 'meals' ? 'comida' : 'bebida',\n    area,\n    category,\n    alcoholicOrNot: type === 'meals' ? '' : alcoholic,\n    name: title,\n    image: photo,\n  };\n\n  const handleFinish = () => {\n    if (!getDoneRecipes()) {\n      setDoneRecipes([\n        { ...handleFavoriteDependencies, doneDate: new Date(), tags },\n      ]);\n    } else {\n      setDoneRecipes([\n        ...getDoneRecipes(),\n        { ...handleFavoriteDependencies, doneDate: new Date(), tags },\n      ]);\n    }\n    history.push('/receitas-feitas');\n  };\n\n  return (\n    <div className=\"page-container\">\n      <img\n        className=\"details__image\"\n        data-testid=\"recipe-photo\"\n        src={ photo }\n        alt=\"meal info\"\n      />\n      <div className=\"title-container\">\n        <div className=\"titles\">\n          <p className=\"details__category\" data-testid=\"recipe-category\">\n            {type === 'meals' ? category : alcoholic}\n          </p>\n          <h1 className=\"details__title\" data-testid=\"recipe-title\">\n            {title}\n          </h1>\n        </div>\n        <div className=\"details\">\n          <ShareButton\n            textToCopy={ `http://localhost:3000/${\n              type === 'meals' ? 'comidas' : 'bebidas'\n            }/${id}` }\n            setIsCopied={ setIsCopied }\n            isCopied={ isCopied }\n          />\n          <FavoriteButton\n            isFavorite={ isFavorite }\n            setIsFavorite={ setIsFavorite }\n            id={ id }\n            favoriteDependencies={ handleFavoriteDependencies }\n          />\n        </div>\n      </div>\n      <p className=\"details__description margin-left\">Ingredientes:</p>\n      <ul className=\"ingredient-list\">\n        {ingredients.map((item, index) => (\n          <li\n            className=\"details__ingredient\"\n            key={ item }\n            data-testid={ `${index}-ingredient-step` }\n          >\n            <input\n              className=\"ingredient__checkbox\"\n              onChange={ (e) => handleCheck(e, index) }\n              type=\"checkbox\"\n            />\n            <span className=\"details__ingredient-name\">{`${item}: `}</span>\n            <span className=\"details__measure\">{measures[index]}</span>\n          </li>\n        ))}\n      </ul>\n      <p className=\"details__description--instructions\">Instruções:</p>\n      <p className=\"details__instructions\" data-testid=\"instructions\">\n        {instructions}\n      </p>\n      <button\n        className={\n          isDisabled ? 'login__btn disabled' : 'login__btn start-recipe'\n        }\n        onClick={ handleFinish }\n        type=\"button\"\n        data-testid=\"finish-recipe-btn\"\n        disabled={ isDisabled }\n      >\n        Finalizar receita\n      </button>\n    </div>\n  );\n}\n\nProgressCard.propTypes = {\n  photo: PropTypes.string,\n  title: PropTypes.string,\n  category: PropTypes.string,\n  ingredients: PropTypes.arrayOf(PropTypes.string),\n  measures: PropTypes.arrayOf(PropTypes.string),\n  instructions: PropTypes.string,\n  type: PropTypes.string,\n  id: PropTypes.string,\n  area: PropTypes.string,\n  alcoholic: PropTypes.string,\n  tags: PropTypes.string,\n};\n\nProgressCard.defaultProps = {\n  photo: '',\n  title: '',\n  category: '',\n  ingredients: [],\n  measures: [],\n  instructions: '',\n  type: '',\n  id: '',\n  area: '',\n  alcoholic: '',\n  tags: '',\n};\n\nexport default ProgressCard;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}
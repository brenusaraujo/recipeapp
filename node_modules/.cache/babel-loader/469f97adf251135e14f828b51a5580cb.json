{"ast":null,"code":"import _slicedToArray from\"/Users/brenoaraujo/projects-to-github/RecipeApp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useContext,useEffect,useState}from'react';import{useHistory}from'react-router';import{requestFoodsOrDrinks,requestRecipesById}from'../services/fetchAPIs';import Card from'../components/Card';import{getFavoriteRecipes,setFavoriteRecipes,getDoneRecipes,getRecipeProgress}from'../services/localStorage';import'../css/RecipeDetails.css';import RecipesContext from'../context/RecipesContext';import ShareButton from'../components/ShareButton';import FavoriteButton from'../components/FavoriteButton';var currentURL=window.location.href;var MAX_RECOMENDATION_CARDS=6;function FoodDetails(props){var id=props.match.params.id;var history=useHistory();var _useState=useState({}),_useState2=_slicedToArray(_useState,2),recipeInfo=_useState2[0],setRecipeInfo=_useState2[1];var strMealThumb=recipeInfo.strMealThumb,strMeal=recipeInfo.strMeal,strCategory=recipeInfo.strCategory,strInstructions=recipeInfo.strInstructions,strYoutube=recipeInfo.strYoutube,strArea=recipeInfo.strArea;var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isDone=_useState4[0],setIsDone=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isInProgress=_useState6[0],setIsInProgressDone=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),renderRecomendations=_useState8[0],setRecomendations=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),isFavorite=_useState10[0],setIsFavorite=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),isCopied=_useState12[0],setIsCopied=_useState12[1];var _useContext=useContext(RecipesContext),sliceIngredients=_useContext.sliceIngredients,sliceMeasures=_useContext.sliceMeasures;useEffect(function(){if(getDoneRecipes()){var currentRecipeIsDone=getDoneRecipes().find(function(recipe){return recipe.id===id;});return setIsDone(currentRecipeIsDone);}return setIsDone(false);},[id]);useEffect(function(){if(getRecipeProgress()){var currentRecipeIsInProgress=!!getRecipeProgress().meals[id];return setIsInProgressDone(currentRecipeIsInProgress);}return setIsInProgressDone(false);},[id]);useEffect(function(){requestRecipesById(id,'themealdb').then(function(_ref){var meals=_ref.meals;return setRecipeInfo(meals[0]);});},[id]);useEffect(function(){requestFoodsOrDrinks('thecocktaildb').then(function(_ref2){var drinks=_ref2.drinks;return setRecomendations(drinks.slice(0,MAX_RECOMENDATION_CARDS));});},[]);useEffect(function(){if(getFavoriteRecipes()){return setIsFavorite(getFavoriteRecipes().find(function(recipe){return recipe.id===id;}));}setFavoriteRecipes([]);},[id]);var ingredientsList=sliceIngredients(recipeInfo);var measuresList=sliceMeasures(recipeInfo);var url=strYoutube?strYoutube.split('=')[1]:strYoutube;var handleFavoriteDependencies={id:id,type:'comida',area:strArea,category:strCategory,alcoholicOrNot:'',name:strMeal,image:strMealThumb};return/*#__PURE__*/React.createElement(\"div\",{className:\"page-container\"},/*#__PURE__*/React.createElement(\"img\",{className:\"details__image\",src:strMealThumb,alt:\"food\",\"data-testid\":\"recipe-photo\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"title-container\"},/*#__PURE__*/React.createElement(\"div\",{className:\"titles\"},/*#__PURE__*/React.createElement(\"h2\",{className:\"details__category\",\"data-testid\":\"recipe-category\"},strCategory),/*#__PURE__*/React.createElement(\"h1\",{className:\"details__title\",\"data-testid\":\"recipe-title\"},strMeal)),/*#__PURE__*/React.createElement(\"div\",{className:\"details\"},/*#__PURE__*/React.createElement(ShareButton,{textToCopy:currentURL,setIsCopied:setIsCopied,isCopied:isCopied}),/*#__PURE__*/React.createElement(FavoriteButton,{isFavorite:isFavorite,setIsFavorite:setIsFavorite,id:id,favoriteDependencies:handleFavoriteDependencies}))),/*#__PURE__*/React.createElement(\"p\",{className:\"details__description margin-left\"},\"Ingredientes:\"),/*#__PURE__*/React.createElement(\"ul\",{className:\"ingredient-list\"},ingredientsList.map(function(ingredient,index){return/*#__PURE__*/React.createElement(\"li\",{className:\"details__ingredient\",key:ingredient,\"data-testid\":\"\".concat(index,\"-ingredient-name-and-measure\")},/*#__PURE__*/React.createElement(\"span\",{className:\"details__ingredient-name\"},\"\".concat(ingredient,\": \")),measuresList[index]?/*#__PURE__*/React.createElement(\"span\",{className:\"details__measure\"},measuresList[index]):'');})),/*#__PURE__*/React.createElement(\"p\",{className:\"details__description--instructions\"},\"Instru\\xE7\\xF5es:\"),/*#__PURE__*/React.createElement(\"p\",{className:\"details__instructions\",\"data-testid\":\"instructions\"},strInstructions),/*#__PURE__*/React.createElement(\"iframe\",{className:\"details__video\",width:\"360\",height:\"315\",src:\"https://youtube.com/embed/\".concat(url),title:strMeal,\"data-testid\":\"video\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"recomended\"},/*#__PURE__*/React.createElement(\"p\",{className:\"details__description center-this\"},\"\\xD3timos acompanhamentos:\"),/*#__PURE__*/React.createElement(\"div\",{className:\"carousel\"},renderRecomendations&&renderRecomendations.map(function(beverage,index){return/*#__PURE__*/React.createElement(Card,{id:\"idDrink\",itemId:beverage.idDrink,header:beverage.strDrink,img:beverage.strDrinkThumb,index:index,key:beverage.idDrink,testId:\"\".concat(index,\"-recomendation-card\")});}))),/*#__PURE__*/React.createElement(\"button\",{className:isDone?'hidden-start-recipe-btn':'login__btn start-recipe',type:\"button\",onClick:function onClick(){return history.push(\"/comidas/\".concat(id,\"/in-progress\"));},\"data-testid\":\"start-recipe-btn\"},isInProgress?'Continuar Receita':'Iniciar Receita'));}export default FoodDetails;","map":{"version":3,"names":["React","useContext","useEffect","useState","useHistory","requestFoodsOrDrinks","requestRecipesById","Card","getFavoriteRecipes","setFavoriteRecipes","getDoneRecipes","getRecipeProgress","RecipesContext","ShareButton","FavoriteButton","currentURL","window","location","href","MAX_RECOMENDATION_CARDS","FoodDetails","props","id","match","params","history","recipeInfo","setRecipeInfo","strMealThumb","strMeal","strCategory","strInstructions","strYoutube","strArea","isDone","setIsDone","isInProgress","setIsInProgressDone","renderRecomendations","setRecomendations","isFavorite","setIsFavorite","isCopied","setIsCopied","sliceIngredients","sliceMeasures","currentRecipeIsDone","find","recipe","currentRecipeIsInProgress","meals","then","drinks","slice","ingredientsList","measuresList","url","split","handleFavoriteDependencies","type","area","category","alcoholicOrNot","name","image","map","ingredient","index","beverage","idDrink","strDrink","strDrinkThumb","push"],"sources":["/Users/brenoaraujo/projects-to-github/RecipeApp/src/pages/FoodDetails.js"],"sourcesContent":["import React, { useContext, useEffect, useState } from 'react';\nimport PropTypes from 'prop-types';\nimport { useHistory } from 'react-router';\nimport {\n  requestFoodsOrDrinks,\n  requestRecipesById,\n} from '../services/fetchAPIs';\nimport Card from '../components/Card';\nimport {\n  getFavoriteRecipes,\n  setFavoriteRecipes,\n  getDoneRecipes,\n  getRecipeProgress,\n} from '../services/localStorage';\nimport '../css/RecipeDetails.css';\nimport RecipesContext from '../context/RecipesContext';\nimport ShareButton from '../components/ShareButton';\nimport FavoriteButton from '../components/FavoriteButton';\n\nconst currentURL = window.location.href;\n\nconst MAX_RECOMENDATION_CARDS = 6;\n\nfunction FoodDetails(props) {\n  const {\n    match: {\n      params: { id },\n    },\n  } = props;\n  const history = useHistory();\n\n  const [recipeInfo, setRecipeInfo] = useState({});\n  const {\n    strMealThumb,\n    strMeal,\n    strCategory,\n    strInstructions,\n    strYoutube,\n    strArea,\n  } = recipeInfo;\n  const [isDone, setIsDone] = useState(false);\n  const [isInProgress, setIsInProgressDone] = useState(false);\n  const [renderRecomendations, setRecomendations] = useState([]);\n  const [isFavorite, setIsFavorite] = useState(false);\n  const [isCopied, setIsCopied] = useState(false);\n  const { sliceIngredients, sliceMeasures } = useContext(RecipesContext);\n\n  useEffect(() => {\n    if (getDoneRecipes()) {\n      const currentRecipeIsDone = getDoneRecipes().find((recipe) => recipe.id === id);\n      return setIsDone(currentRecipeIsDone);\n    }\n    return setIsDone(false);\n  }, [id]);\n\n  useEffect(() => {\n    if (getRecipeProgress()) {\n      const currentRecipeIsInProgress = !!getRecipeProgress().meals[id];\n      return setIsInProgressDone(currentRecipeIsInProgress);\n    }\n    return setIsInProgressDone(false);\n  }, [id]);\n\n  useEffect(() => {\n    requestRecipesById(id, 'themealdb').then(({ meals }) => setRecipeInfo(meals[0]));\n  }, [id]);\n\n  useEffect(() => {\n    requestFoodsOrDrinks('thecocktaildb')\n      .then(({ drinks }) => setRecomendations(drinks.slice(0, MAX_RECOMENDATION_CARDS)));\n  }, []);\n\n  useEffect(() => {\n    if (getFavoriteRecipes()) {\n      return setIsFavorite(\n        getFavoriteRecipes().find((recipe) => recipe.id === id),\n      );\n    }\n    setFavoriteRecipes([]);\n  }, [id]);\n\n  const ingredientsList = sliceIngredients(recipeInfo);\n  const measuresList = sliceMeasures(recipeInfo);\n\n  const url = strYoutube ? strYoutube.split('=')[1] : strYoutube;\n\n  const handleFavoriteDependencies = {\n    id,\n    type: 'comida',\n    area: strArea,\n    category: strCategory,\n    alcoholicOrNot: '',\n    name: strMeal,\n    image: strMealThumb,\n  };\n\n  return (\n    <div className=\"page-container\">\n      <img\n        className=\"details__image\"\n        src={ strMealThumb }\n        alt=\"food\"\n        data-testid=\"recipe-photo\"\n      />\n      <div className=\"title-container\">\n        <div className=\"titles\">\n          <h2 className=\"details__category\" data-testid=\"recipe-category\">\n            {strCategory}\n          </h2>\n          <h1 className=\"details__title\" data-testid=\"recipe-title\">\n            {strMeal}\n          </h1>\n        </div>\n        <div className=\"details\">\n          <ShareButton\n            textToCopy={ currentURL }\n            setIsCopied={ setIsCopied }\n            isCopied={ isCopied }\n          />\n          <FavoriteButton\n            isFavorite={ isFavorite }\n            setIsFavorite={ setIsFavorite }\n            id={ id }\n            favoriteDependencies={ handleFavoriteDependencies }\n          />\n        </div>\n      </div>\n      <p className=\"details__description margin-left\">Ingredientes:</p>\n      <ul className=\"ingredient-list\">\n        {ingredientsList.map((ingredient, index) => (\n          <li\n            className=\"details__ingredient\"\n            key={ ingredient }\n            data-testid={ `${index}-ingredient-name-and-measure` }\n          >\n            <span className=\"details__ingredient-name\">{`${ingredient}: `}</span>\n            {measuresList[index] ? (\n              <span className=\"details__measure\">{measuresList[index]}</span>\n            ) : (\n              ''\n            )}\n          </li>\n        ))}\n      </ul>\n      <p className=\"details__description--instructions\">Instruções:</p>\n      <p className=\"details__instructions\" data-testid=\"instructions\">\n        {strInstructions}\n      </p>\n      <iframe\n        className=\"details__video\"\n        width=\"360\"\n        height=\"315\"\n        src={ `https://youtube.com/embed/${url}` }\n        title={ strMeal }\n        data-testid=\"video\"\n      />\n      <div className=\"recomended\">\n        <p className=\"details__description center-this\">Ótimos acompanhamentos:</p>\n        <div className=\"carousel\">\n          {renderRecomendations\n            && renderRecomendations.map((beverage, index) => (\n              <Card\n                id=\"idDrink\"\n                itemId={ beverage.idDrink }\n                header={ beverage.strDrink }\n                img={ beverage.strDrinkThumb }\n                index={ index }\n                key={ beverage.idDrink }\n                testId={ `${index}-recomendation-card` }\n              />\n            ))}\n        </div>\n      </div>\n      <button\n        className={ isDone ? 'hidden-start-recipe-btn' : 'login__btn start-recipe' }\n        type=\"button\"\n        onClick={ () => history.push(`/comidas/${id}/in-progress`) }\n        data-testid=\"start-recipe-btn\"\n      >\n        {isInProgress ? 'Continuar Receita' : 'Iniciar Receita' }\n      </button>\n    </div>\n  );\n}\n\nFoodDetails.propTypes = {\n  match: PropTypes.shape({\n    params: PropTypes.shape({\n      id: PropTypes.string.isRequired,\n    }).isRequired,\n  }).isRequired,\n};\n\nexport default FoodDetails;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}